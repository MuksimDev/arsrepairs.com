{"version":3,"sources":["file:///C:/Users/maxim/Documents/Dev/arsrepairs.com/assets/ts/contact-form-entry.ts"],"sourcesContent":["/**\r\n * Contact Form Module\r\n * Handles form validation and submission for the contact form using Web3Forms\r\n */\r\n\r\nimport { onDOMReady } from '../utils/dom';\r\n\r\n/**\r\n * Show error message for a field\r\n */\r\nfunction showError(fieldId: string, message: string): void {\r\n  const field = document.getElementById(fieldId);\r\n  const errorEl = document.getElementById(fieldId + '-error');\r\n  \r\n  if (field \u0026\u0026 errorEl) {\r\n    field.setAttribute('aria-invalid', 'true');\r\n    field.classList.add('contact-form__input--error');\r\n    errorEl.textContent = message;\r\n    errorEl.style.display = 'block';\r\n  }\r\n}\r\n\r\n/**\r\n * Clear error message for a field\r\n */\r\nfunction clearError(fieldId: string): void {\r\n  const field = document.getElementById(fieldId);\r\n  const errorEl = document.getElementById(fieldId + '-error');\r\n  \r\n  if (field \u0026\u0026 errorEl) {\r\n    field.removeAttribute('aria-invalid');\r\n    field.classList.remove('contact-form__input--error');\r\n    errorEl.textContent = '';\r\n    errorEl.style.display = 'none';\r\n  }\r\n}\r\n\r\n/**\r\n * Validator function type\r\n */\r\ntype Validator = (value: string) =\u003e string | null;\r\n\r\n/**\r\n * Validators for all form fields\r\n */\r\nconst validators: Record\u003cstring, Validator\u003e = {\r\n  'name': (value: string) =\u003e {\r\n    if (!value || value.trim().length === 0) return 'Name is required';\r\n    if (value.length \u003c 2) return 'Name must be at least 2 characters';\r\n    return null;\r\n  },\r\n  'email': (value: string) =\u003e {\r\n    if (!value || value.trim().length === 0) return 'Email is required';\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(value)) return 'Please enter a valid email address';\r\n    return null;\r\n  },\r\n  'phone': (value: string) =\u003e {\r\n    if (value \u0026\u0026 value.trim().length \u003e 0) {\r\n      const digitsOnly = value.replace(/\\D/g, '');\r\n      if (digitsOnly.length \u003e 0 \u0026\u0026 digitsOnly.length \u003c 10) {\r\n        return 'Please enter a valid phone number';\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n  'message': (value: string) =\u003e {\r\n    if (!value || value.trim().length === 0) return 'Message is required';\r\n    if (value.length \u003c 10) return 'Message must be at least 10 characters';\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Initialize real-time validation for all fields\r\n */\r\nfunction initFieldValidation(): void {\r\n  Object.keys(validators).forEach(fieldId =\u003e {\r\n    const field = document.getElementById(fieldId);\r\n    if (!field) return;\r\n\r\n    const validator = validators[fieldId];\r\n    if (!validator) return;\r\n\r\n    // Validate on blur\r\n    field.addEventListener('blur', function(this: HTMLElement) {\r\n      const input = this as HTMLInputElement | HTMLTextAreaElement;\r\n      const error = validator(input.value);\r\n      if (error) {\r\n        showError(fieldId, error);\r\n      } else {\r\n        clearError(fieldId);\r\n      }\r\n    });\r\n    \r\n    // Validate on input (only if field already has errors)\r\n    field.addEventListener('input', function(this: HTMLElement) {\r\n      if (this.getAttribute('aria-invalid') === 'true') {\r\n        const input = this as HTMLInputElement | HTMLTextAreaElement;\r\n        const error = validator(input.value);\r\n        if (error) {\r\n          showError(fieldId, error);\r\n        } else {\r\n          clearError(fieldId);\r\n        }\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Initialize contact form\r\n */\r\nexport const initContactForm = (): void =\u003e {\r\n  const form = document.querySelector\u003cHTMLFormElement\u003e('form[name=\"contact\"]');\r\n  if (!form) return;\r\n\r\n  const submitButton = document.getElementById('contact-submit');\r\n  const liveRegion = document.getElementById('contact-live-region');\r\n  const errorContainer = document.getElementById('contact-error');\r\n\r\n  // Initialize field validation\r\n  initFieldValidation();\r\n\r\n  // Handle form submission\r\n  form.addEventListener('submit', async function(e: Event) {\r\n    e.preventDefault();\r\n    \r\n    if (errorContainer) errorContainer.style.display = 'none';\r\n    \r\n    let isValid = true;\r\n    Object.keys(validators).forEach(fieldId =\u003e {\r\n      const field = document.getElementById(fieldId) as HTMLInputElement | HTMLTextAreaElement | null;\r\n      if (field) {\r\n        const error = validators[fieldId](field.value);\r\n        if (error) {\r\n          showError(fieldId, error);\r\n          isValid = false;\r\n        } else {\r\n          clearError(fieldId);\r\n        }\r\n      }\r\n    });\r\n\r\n    if (!isValid) {\r\n      if (errorContainer) {\r\n        errorContainer.textContent = 'Please correct the errors below before submitting.';\r\n        errorContainer.style.display = 'block';\r\n      }\r\n      if (liveRegion) {\r\n        liveRegion.textContent = 'Form has errors. Please review and correct them.';\r\n      }\r\n      const firstError = form.querySelector\u003cHTMLElement\u003e('[aria-invalid=\"true\"]');\r\n      if (firstError) firstError.focus();\r\n      return;\r\n    }\r\n\r\n    if (submitButton) {\r\n      submitButton.classList.add('contact-form__submit--loading');\r\n      (submitButton as HTMLButtonElement).disabled = true;\r\n      const btnText = submitButton.querySelector\u003cHTMLElement\u003e('.btn__text');\r\n      if (btnText) btnText.textContent = 'Sending...';\r\n    }\r\n\r\n    if (liveRegion) {\r\n      liveRegion.textContent = 'Sending your message...';\r\n    }\r\n\r\n    // Prepare form data for Web3Forms\r\n    const formData = new FormData(form);\r\n\r\n    try {\r\n      const response = await fetch('https://api.web3forms.com/submit', {\r\n        method: 'POST',\r\n        body: formData\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        // Success - redirect to thank you page immediately\r\n        if (liveRegion) {\r\n          liveRegion.textContent = 'Message sent successfully! Redirecting...';\r\n        }\r\n        // Use replace() to avoid adding to browser history\r\n        const redirectUrl = form.querySelector\u003cHTMLInputElement\u003e('input[name=\"redirect\"]')?.value || '/contact-us/thank-you/';\r\n        window.location.replace(redirectUrl);\r\n      } else {\r\n        // Handle error from Web3Forms\r\n        throw new Error(data.message || 'Failed to send message');\r\n      }\r\n    } catch (error) {\r\n      // Handle network or other errors\r\n      const errorMessage = error instanceof Error ? error.message : 'An error occurred. Please try again later.';\r\n      \r\n      if (errorContainer) {\r\n        errorContainer.textContent = errorMessage;\r\n        errorContainer.style.display = 'block';\r\n      }\r\n      if (liveRegion) {\r\n        liveRegion.textContent = 'Error sending message. Please try again.';\r\n      }\r\n      \r\n      if (submitButton) {\r\n        submitButton.classList.remove('contact-form__submit--loading');\r\n        (submitButton as HTMLButtonElement).disabled = false;\r\n        const btnText = submitButton.querySelector\u003cHTMLElement\u003e('.btn__text');\r\n        if (btnText) btnText.textContent = 'Send Message';\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\n","/**\r\n * DOM utility functions\r\n */\r\n\r\n/**\r\n * Checks if the current viewport is mobile size\r\n */\r\nexport const isMobile = (): boolean =\u003e window.innerWidth \u003c= 1280;\r\n\r\n/**\r\n * Checks if running on localhost\r\n */\r\nexport const isLocalhost = (): boolean =\u003e {\r\n  return window.location.hostname === \"localhost\" || window.location.hostname === \"127.0.0.1\";\r\n};\r\n\r\n/**\r\n * Safely executes a function when DOM is ready\r\n */\r\nexport const onDOMReady = (callback: () =\u003e void): void =\u003e {\r\n  if (document.readyState === \"loading\") {\r\n    document.addEventListener(\"DOMContentLoaded\", callback);\r\n  } else {\r\n    callback();\r\n  }\r\n};\r\n\r\n","/**\r\n * Contact Form Entry Point\r\n * This file is compiled separately and loaded only when the contact form is present\r\n */\r\n\r\nimport { initContactForm } from './modules/contact-form';\r\nimport { onDOMReady } from './utils/dom';\r\n\r\n// Initialize the contact form when DOM is ready\r\nonDOMReady(() =\u003e {\r\n  initContactForm();\r\n});\r\n\r\n"],"mappings":"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","names":[]}